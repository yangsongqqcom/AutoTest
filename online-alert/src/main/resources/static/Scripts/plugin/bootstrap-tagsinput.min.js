/* SmartAdmin - v1.4.1 - 2014-06-26 */
!function(i){function j(a,d){this.itemsArray=[];this.$element=i(a);this.$element.hide();this.isSelect="SELECT"===a.tagName;this.multiple=this.isSelect&&a.hasAttribute("multiple");this.objectItems=d&&d.itemValue;this.placeholderText=a.hasAttribute("placeholder")?this.$element.attr("placeholder"):"";this.inputSize=Math.max(1,this.placeholderText.length);this.$container=i('<div class="bootstrap-tagsinput"></div>');this.$input=i('<input size="'+this.inputSize+'" type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container);this.$element.after(this.$container);this.build(d)}function k(d,e){if("function"!=typeof d[e]){var f=d[e];d[e]=function(b){return b[f]}}}function l(d,e){if("function"!=typeof d[e]){var f=d[e];d[e]=function(){return f}}}function m(b){return b?p.text(b).html():""}function n(d){var e=0;if(document.selection){d.focus();var f=document.selection.createRange();f.moveStart("character",-d.value.length),e=f.text.length}else{(d.selectionStart||"0"==d.selectionStart)&&(e=d.selectionStart)}return e}var o={tagClass:function(){return"label label-info"},itemValue:function(b){return b?b.toString():b},itemText:function(b){return this.itemValue(b)},freeInput:!0,maxTags:void 0,confirmKeys:[13],onTagExists:function(c,d){d.hide().fadeIn()}};j.prototype={constructor:j,add:function(a,e){var q=this;if(!(q.options.maxTags&&q.itemsArray.length>=q.options.maxTags||a!==!1&&!a)){if("object"==typeof a&&!q.objectItems){throw"Can't add objects when itemValue option is not set"}if(!a.toString().match(/^\s*$/)){if(q.isSelect&&!q.multiple&&q.itemsArray.length>0){q.remove(q.itemsArray[0])}if("string"==typeof a&&"INPUT"===this.$element[0].tagName){var r=a.split(",");if(r.length>1){for(var s=0;s<r.length;s++){this.add(r[s],!0)}return void (e||q.pushVal())}}var t=q.options.itemValue(a),u=q.options.itemText(a),v=q.options.tagClass(a),w=i.grep(q.itemsArray,function(b){return q.options.itemValue(b)===t})[0];if(w){if(q.options.onTagExists){var x=i(".tag",q.$container).filter(function(){return i(this).data("item")===w});q.options.onTagExists(a,x)}}else{q.itemsArray.push(a);var y=i('<span class="tag '+m(v)+'">'+m(u)+'<span data-role="remove"></span></span>');y.data("item",a),q.findInputWrapper().before(y),y.after(" ");if(q.isSelect&&!i('option[value="'+escape(t)+'"]',q.$element)[0]){var z=i("<option selected>"+m(u)+"</option>");z.data("item",a),z.attr("value",t),q.$element.append(z)}e||q.pushVal();q.options.maxTags===q.itemsArray.length&&q.$container.addClass("bootstrap-tagsinput-max");q.$element.trigger(i.Event("itemAdded",{item:a}))}}}},remove:function(a,e){var f=this;if(f.objectItems){if(a="object"==typeof a){i.grep(f.itemsArray,function(b){return f.options.itemValue(b)==f.options.itemValue(a)})[0]}else{i.grep(f.itemsArray,function(b){return f.options.itemValue(b)==a})[0]}}if(a){i(".tag",f.$container).filter(function(){return i(this).data("item")===a}).remove(),i("option",f.$element).filter(function(){return i(this).data("item")===a}).remove(),f.itemsArray.splice(i.inArray(a,f.itemsArray),1)}e||f.pushVal(),f.options.maxTags>f.itemsArray.length&&f.$container.removeClass("bootstrap-tagsinput-max"),f.$element.trigger(i.Event("itemRemoved",{item:a}))},removeAll:function(d){var a=this;for(i(".tag",a.$container).remove(),i("option",a.$element).remove();a.itemsArray.length>0;){a.itemsArray.pop()}d||a.pushVal();a.options.maxTags&&!this.isEnabled()&&this.enable()},refresh:function(){var a=this;i(".tag",a.$container).each(function(){var b=i(this),e=b.data("item"),q=a.options.itemValue(e),r=a.options.itemText(e),s=a.options.tagClass(e);b.attr("class",null);b.addClass("tag "+m(s));b.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=m(r);if(a.isSelect){var t=i("option",a.$element).filter(function(){return i(this).data("item")===e});t.attr("value",q)}})},refreshTags:function(){var a=this;var c=a.$element.val();a.removeAll(!0),a.add(c)},items:function(){return this.itemsArray},pushVal:function(){var a=this,d=i.map(a.items(),function(b){return a.options.itemValue(b).toString()});a.$element.val(d,!0).trigger("change")},build:function(a){var c=this;c.options=i.extend({},o,a);var d=c.options.typeahead||{};c.objectItems&&(c.options.freeInput=!1),k(c.options,"itemValue"),k(c.options,"itemText"),k(c.options,"tagClass"),c.options.source&&(d.source=c.options.source);if(d.source&&i.fn.typeahead){(l(d,"source"),c.$input.typeahead({source:function(e,h){function q(f){for(var t=[],u=0;u<f.length;u++){var v=c.options.itemText(f[u]);r[v]=f[u],t.push(v)}h(t)}this.map={};var r=this.map,s=d.source(e);i.isFunction(s.success)?s.success(q):i.when(s).then(q)},updater:function(b){c.add(this.map[b])},matcher:function(b){return -1!==b.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(b){return b.sort()},highlighter:function(e){var f=new RegExp("("+this.query+")","gi");return e.replace(f,"<strong>$1</strong>")}}))}c.$container.on("click",i.proxy(function(){c.$input.focus()},c)),c.$container.on("keydown","input",i.proxy(function(e){var f=i(e.target),q=c.findInputWrapper();switch(e.which){case 8:if(0===n(f[0])){var r=q.prev();r&&c.remove(r.data("item"))}break;case 46:if(0===n(f[0])){var s=q.next();s&&c.remove(s.data("item"))}break;case 37:var t=q.prev();0===f.val().length&&t[0]&&(t.before(q),f.focus());break;case 39:var u=q.next();0===f.val().length&&u[0]&&(u.after(q),f.focus());break;default:if(c.options.freeInput&&i.inArray(e.which,c.options.confirmKeys)>=0){c.add(f.val()),f.val(""),e.preventDefault()}}f.attr("size",Math.max(this.inputSize,f.val().length))},c)),c.$container.on("click","[data-role=remove]",i.proxy(function(e){c.remove(i(e.target).closest(".tag").data("item"))},c));if(c.options.itemValue===o.itemValue){if("INPUT"===c.$element[0].tagName){c.add(c.$element.val())}else{i("option",c.$element).each(function(){c.add(i(this).attr("value"),!0)})}}},destroy:function(){var b=this;b.$container.off("keypress","input"),b.$container.off("click","[role=remove]"),b.$container.remove(),b.$element.removeData("tagsinput"),b.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var a=this.$input[0],d=this.$container[0];a&&a.parentNode!==d;){a=a.parentNode}return i(a)}},i.fn.tagsinput=function(a,b){var f=[];this.each(function(){var c=i(this).data("tagsinput");if(c){var d=c[a](b);void 0!==d&&f.push(d)}else{c=new j(this,a);i(this).data("tagsinput",c);f.push(c);"SELECT"===this.tagName&&i("option",i(this)).attr("selected","selected");i(this).val(i(this).val())}});return"string"==typeof a?f.length>1?f:f[0]:f},i.fn.tagsinput.Constructor=j;var p=i("<div />");i(function(){i("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})}(window.jQuery);